(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{7558:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/speed",function(){return t(3551)}])},3551:function(e,a,t){"use strict";t.r(a),t.d(a,{currentRPMAtom:function(){return s}});var r=t(5893),i=t(5103),c=t(8583),n=t(7294);let s=(0,i.cn)(0);a.default=()=>{let[e,a]=(0,n.useState)({modelNumber:"",hardwareRevision:"",softwareRevision:"",manufacturerName:""}),[t,i]=(0,c.KO)(s),[o,l]=(0,n.useState)(null),d=e=>{let a=e.target.value,t=null==a?void 0:a.getUint16(1,!0);if(null==a){console.error("No value received from characteristic");return}console.log("rpmValue",t),void 0!==t&&i(t)};async function u(e){let t=await e.getPrimaryService("0000180a-0000-1000-8000-00805f9b34fb"),r=await t.getCharacteristic("00002a24-0000-1000-8000-00805f9b34fb"),i=await t.getCharacteristic("00002a27-0000-1000-8000-00805f9b34fb"),c=await t.getCharacteristic("00002a28-0000-1000-8000-00805f9b34fb"),n=await t.getCharacteristic("00002a29-0000-1000-8000-00805f9b34fb"),s=new TextDecoder().decode(await r.readValue()),o=new TextDecoder().decode(await i.readValue()),l=new TextDecoder().decode(await c.readValue()),d=new TextDecoder().decode(await n.readValue());console.log("Model Number:",s),console.log("Hardware Revision:",o),console.log("Software Revision:",l),console.log("Manufacturer Name:",d),a({modelNumber:s,hardwareRevision:o,softwareRevision:l,manufacturerName:d})}let[f,b]=(0,n.useState)("");async function h(e){let a=await e.getPrimaryService("00001801-0000-1000-8000-00805f9b34fb");console.log("Generic Attribute Service:",a),b(a.uuid)}let[w,g]=(0,n.useState)({deviceName:"",appearance:"",peripheralPreferredConnectionParameters:"",centralAddressResolution:""});async function p(e){let a=await e.getPrimaryService("00001800-0000-1000-8000-00805f9b34fb"),t=await a.getCharacteristic("00002a00-0000-1000-8000-00805f9b34fb"),r=await a.getCharacteristic("00002a01-0000-1000-8000-00805f9b34fb"),i=await a.getCharacteristic("00002a04-0000-1000-8000-00805f9b34fb"),c=await a.getCharacteristic("00002aa6-0000-1000-8000-00805f9b34fb"),n=new TextDecoder().decode(await t.readValue()),s=(await r.readValue()).getUint16(0,!0),o=await i.readValue(),l=o.getUint16(0,!0),d=o.getUint16(2,!0),u=o.getUint16(4,!0),f=o.getUint16(6,!0),b="Min Interval: ".concat(l,", Max Interval: ").concat(d,", Slave Latency: ").concat(u,", Supervision Timeout: ").concat(f),h=await c.readValue(),w=1===h.getUint8(0)?"Supported":"Not Supported",p=s.toString();g({deviceName:n,appearance:p,peripheralPreferredConnectionParameters:b,centralAddressResolution:w})}let[x,v]=(0,n.useState)({scControlPoint:"",cscMeasurement:"",cscFeature:"",sensorLocation:""});async function m(e){let a=await e.getPrimaryService("00001816-0000-1000-8000-00805f9b34fb"),t=await a.getCharacteristic("00002a55-0000-1000-8000-00805f9b34fb"),r=await a.getCharacteristic("00002a5b-0000-1000-8000-00805f9b34fb"),i=await a.getCharacteristic("00002a5c-0000-1000-8000-00805f9b34fb"),c=await a.getCharacteristic("00002a5d-0000-1000-8000-00805f9b34fb"),n=new TextDecoder().decode(await t.readValue()),s=new TextDecoder().decode(await r.readValue()),o=new TextDecoder().decode(await i.readValue()),l=new TextDecoder().decode(await c.readValue());v({scControlPoint:n,cscMeasurement:s,cscFeature:o,sensorLocation:l})}async function j(){try{let e=await navigator.bluetooth.requestDevice({filters:[{services:["00001816-0000-1000-8000-00805f9b34fb"]}],optionalServices:["0000180f-0000-1000-8000-00805f9b34fb","0000180a-0000-1000-8000-00805f9b34fb","00001801-0000-1000-8000-00805f9b34fb","00001800-0000-1000-8000-00805f9b34fb"]});console.log("1",e);let a=await e.gatt.connect();console.log("2",a),u(a),await h(a),await p(a),await m(a);let t=await a.getPrimaryService("00001816-0000-1000-8000-00805f9b34fb");console.log("3",t);let r=await a.getPrimaryService("0000180f-0000-1000-8000-00805f9b34fb"),i=await r.getCharacteristic("00002a19-0000-1000-8000-00805f9b34fb"),c=await i.readValue(),n=c.getUint8(0);console.log("Battery Level:",n),l(n);let s=document.getElementById("batteryLevel");null!==s&&(s.textContent="バッテリー残量: ".concat(n,"%")),await new Promise(e=>setTimeout(e,1e3));let o=await t.getCharacteristic("00002a5b-0000-1000-8000-00805f9b34fb");console.log("4",o),o.addEventListener("characteristicvaluechanged",d),await o.startNotifications(),console.log("5",o)}catch(e){console.error("Error:",e)}}return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"ケーデンスセンサーの読み取り"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:" 1.センサーに接続ボタンをクリックするとデバイス検索が入る"}),(0,r.jsx)("p",{children:"2.ペア設定をクリックするとデバイスが読み取られる"}),(0,r.jsx)("p",{children:"3.回転するとデータが更新されていく"})]}),(0,r.jsx)("button",{onClick:j,children:"センサーに接続"}),null!==o?(0,r.jsxs)("span",{id:"batteryLevel",children:["バッテリー残量: ",o,"%"]}):(0,r.jsx)("span",{id:"batteryLevel",children:"バッテリー残量: ---%"}),(0,r.jsxs)("p",{children:["RPM:",t]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"デバイス情報"}),(0,r.jsxs)("p",{children:["モデル番号: ",e.modelNumber]}),(0,r.jsxs)("p",{children:["ハードウェアリビジョン: ",e.hardwareRevision]}),(0,r.jsxs)("p",{children:["ソフトウェアリビジョン: ",e.softwareRevision]}),(0,r.jsxs)("p",{children:["製造者名: ",e.manufacturerName]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Generic Access 情報"}),(0,r.jsxs)("p",{children:["デバイス名: ",w.deviceName]}),(0,r.jsxs)("p",{children:["外観: ",w.appearance]}),(0,r.jsxs)("p",{children:["Peripheral Preferred Connection Parameters:"," ",w.peripheralPreferredConnectionParameters]}),(0,r.jsxs)("p",{children:["Central Address Resolution: ",w.centralAddressResolution]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Generic Attribute 情報"}),(0,r.jsxs)("p",{children:["サービスUUID: ",f]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"サイクリング情報"}),(0,r.jsxs)("p",{children:["SC Control Point: ",x.scControlPoint]}),(0,r.jsxs)("p",{children:["CSC Measurement: ",x.cscMeasurement]}),(0,r.jsxs)("p",{children:["CSC Feature: ",x.cscFeature]}),(0,r.jsxs)("p",{children:["Sensor Location: ",x.sensorLocation]})]})]})}}},function(e){e.O(0,[583,774,888,179],function(){return e(e.s=7558)}),_N_E=e.O()}]);