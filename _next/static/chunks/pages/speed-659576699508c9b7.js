(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{7558:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/speed",function(){return a(3551)}])},3551:function(e,t,a){"use strict";a.r(t),a.d(t,{currentRPMAtom:function(){return o}});var r=a(5893),i=a(5103),n=a(8583),c=a(7294);let o=(0,i.cn)(0);t.default=()=>{let[e,t]=(0,c.useState)({modelNumber:"",hardwareRevision:"",softwareRevision:"",manufacturerName:""}),[a,i]=(0,n.KO)(o),[s,l]=(0,c.useState)(null),d=e=>{let t=e.target.value,a=null==t?void 0:t.getUint16(1,!0);if(null==t){console.error("No value received from characteristic");return}console.log("rpmValue",a),void 0!==a&&i(a)};async function u(e){let a=await e.getPrimaryService("0000180a-0000-1000-8000-00805f9b34fb"),r=await a.getCharacteristic("00002a24-0000-1000-8000-00805f9b34fb"),i=await a.getCharacteristic("00002a27-0000-1000-8000-00805f9b34fb"),n=await a.getCharacteristic("00002a28-0000-1000-8000-00805f9b34fb"),c=await a.getCharacteristic("00002a29-0000-1000-8000-00805f9b34fb"),o=new TextDecoder().decode(await r.readValue()),s=new TextDecoder().decode(await i.readValue()),l=new TextDecoder().decode(await n.readValue()),d=new TextDecoder().decode(await c.readValue());console.log("Model Number:",o),console.log("Hardware Revision:",s),console.log("Software Revision:",l),console.log("Manufacturer Name:",d),t({modelNumber:o,hardwareRevision:s,softwareRevision:l,manufacturerName:d})}let[f,b]=(0,c.useState)("");async function h(e){let t=await e.getPrimaryService("00001801-0000-1000-8000-00805f9b34fb");console.log("Generic Attribute Service:",t),b(t.uuid)}let[w,g]=(0,c.useState)({deviceName:"",appearance:"",peripheralPreferredConnectionParameters:"",centralAddressResolution:""});async function v(e){let t=await e.getPrimaryService("00001800-0000-1000-8000-00805f9b34fb"),a=await t.getCharacteristic("00002a00-0000-1000-8000-00805f9b34fb"),r=await t.getCharacteristic("00002a01-0000-1000-8000-00805f9b34fb"),i=await t.getCharacteristic("00002a04-0000-1000-8000-00805f9b34fb"),n=await t.getCharacteristic("00002aa6-0000-1000-8000-00805f9b34fb"),c=new TextDecoder().decode(await a.readValue()),o=(await r.readValue()).getUint16(0,!0),s=await i.readValue(),l=s.getUint16(0,!0),d=s.getUint16(2,!0),u=s.getUint16(4,!0),f=s.getUint16(6,!0),b="Min Interval: ".concat(l,", Max Interval: ").concat(d,", Slave Latency: ").concat(u,", Supervision Timeout: ").concat(f),h=await n.readValue(),w=1===h.getUint8(0)?"Supported":"Not Supported",v=o.toString();g({deviceName:c,appearance:v,peripheralPreferredConnectionParameters:b,centralAddressResolution:w})}async function p(){try{let e=await navigator.bluetooth.requestDevice({filters:[{services:["00001816-0000-1000-8000-00805f9b34fb"]}],optionalServices:["0000180f-0000-1000-8000-00805f9b34fb","0000180a-0000-1000-8000-00805f9b34fb","00001801-0000-1000-8000-00805f9b34fb","00001800-0000-1000-8000-00805f9b34fb"]});console.log("1",e);let t=await e.gatt.connect();console.log("2",t),u(t),await h(t),await v(t);let a=await t.getPrimaryService("00001816-0000-1000-8000-00805f9b34fb");console.log("3",a);let r=await t.getPrimaryService("0000180f-0000-1000-8000-00805f9b34fb"),i=await r.getCharacteristic("00002a19-0000-1000-8000-00805f9b34fb"),n=await i.readValue(),c=n.getUint8(0);console.log("Battery Level:",c),l(c);let o=document.getElementById("batteryLevel");null!==o&&(o.textContent="バッテリー残量: ".concat(c,"%")),await new Promise(e=>setTimeout(e,1e3));let s=await a.getCharacteristic("00002a5b-0000-1000-8000-00805f9b34fb");console.log("4",s),s.addEventListener("characteristicvaluechanged",d),await s.startNotifications(),console.log("5",s)}catch(e){console.error("Error:",e)}}return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"ケーデンスセンサーの読み取り"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:" 1.センサーに接続ボタンをクリックするとデバイス検索が入る"}),(0,r.jsx)("p",{children:"2.ペア設定をクリックするとデバイスが読み取られる"}),(0,r.jsx)("p",{children:"3.回転するとデータが更新されていく"})]}),(0,r.jsx)("button",{onClick:p,children:"センサーに接続"}),null!==s?(0,r.jsxs)("span",{id:"batteryLevel",children:["バッテリー残量: ",s,"%"]}):(0,r.jsx)("span",{id:"batteryLevel",children:"バッテリー残量: ---%"}),(0,r.jsxs)("p",{children:["RPM:",a]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"デバイス情報"}),(0,r.jsxs)("p",{children:["モデル番号: ",e.modelNumber]}),(0,r.jsxs)("p",{children:["ハードウェアリビジョン: ",e.hardwareRevision]}),(0,r.jsxs)("p",{children:["ソフトウェアリビジョン: ",e.softwareRevision]}),(0,r.jsxs)("p",{children:["製造者名: ",e.manufacturerName]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Generic Access 情報"}),(0,r.jsxs)("p",{children:["デバイス名: ",w.deviceName]}),(0,r.jsxs)("p",{children:["image: ",w.appearance]}),(0,r.jsxs)("p",{children:["Peripheral Preferred Connection Parameters:"," ",w.peripheralPreferredConnectionParameters]}),(0,r.jsxs)("p",{children:["Central Address Resolution: ",w.centralAddressResolution]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{children:"Generic Attribute 情報"}),(0,r.jsxs)("p",{children:["サービスUUID: ",f]})]})]})}}},function(e){e.O(0,[583,774,888,179],function(){return e(e.s=7558)}),_N_E=e.O()}]);