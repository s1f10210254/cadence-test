(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[696],{20:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/arry",function(){return n(8127)}])},8127:function(e,t,n){"use strict";n.r(t),n.d(t,{ArryRPMAtom:function(){return o},currentRPMAtom:function(){return c}});var r=n(5893),i=n(5103),l=n(8583),a=n(7294);let c=(0,i.cn)(0),o=(0,i.cn)([]);t.default=()=>{let[e,t]=(0,a.useState)(null),[n,i]=(0,l.KO)(o),c=e=>{let t=null,r=e.target.value,l=null==r?void 0:r.getUint16(1,!0);if(void 0===l)return;if(null===t){t=l;return}let a=l-t,c=[];return c.push(a),c.length>20&&c.shift(),i(c),n},s=e=>{let t=c(e);void 0!==t&&i(t)},u=n[n.length-1];async function f(){try{let e=await navigator.bluetooth.requestDevice({filters:[{services:["00001816-0000-1000-8000-00805f9b34fb"]}],optionalServices:["0000180f-0000-1000-8000-00805f9b34fb"]});console.log("1",e);let n=await e.gatt.connect();console.log("2",n);let r=await n.getPrimaryService("00001816-0000-1000-8000-00805f9b34fb");console.log("3",r);let i=await n.getPrimaryService("0000180f-0000-1000-8000-00805f9b34fb"),l=await i.getCharacteristic("00002a19-0000-1000-8000-00805f9b34fb"),a=await l.readValue(),c=a.getUint8(0);console.log("Battery Level:",c),t(c);let o=document.getElementById("batteryLevel");null!==o&&(o.textContent="バッテリー残量: ".concat(c,"%")),await new Promise(e=>setTimeout(e,1e3));let u=await r.getCharacteristic("00002a5b-0000-1000-8000-00805f9b34fb");console.log("4",u),u.addEventListener("characteristicvaluechanged",s),await u.startNotifications(),console.log("5",u)}catch(e){console.error("Error:",e)}}return(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{children:"ケーデンスセンサーの読み取り"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:" 1.センサーに接続ボタンをクリックするとデバイス検索が入る"}),(0,r.jsx)("p",{children:"2.ペア設定をクリックするとデバイスが読み取られる"}),(0,r.jsx)("p",{children:"3.回転するとデータが更新されていく"})]}),(0,r.jsx)("button",{onClick:f,children:"センサーに接続"}),null!==e?(0,r.jsxs)("span",{id:"batteryLevel",children:["バッテリー残量: ",e,"%"]}):(0,r.jsx)("span",{id:"batteryLevel",children:"バッテリー残量: ---%"}),(0,r.jsxs)("p",{children:["回転数:",u]})]})}}},function(e){e.O(0,[583,774,888,179],function(){return e(e.s=20)}),_N_E=e.O()}]);